<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOAP DNS Lookup Service Documentation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            padding: 2rem;
        }
        h1, h2 {
            color: #2c3e50;
        }
        pre {
            background-color: #ecf0f1;
            padding: 1rem;
            border-radius: 5px;
            overflow-x: auto;
        }
        code {
            font-family: Consolas, "Courier New", monospace;
        }
        ul {
            line-height: 1.8;
        }
        .note {
            background-color: #e7f3fe;
            border-left: 6px solid #2196F3;
            margin: 1rem 0;
            padding: 1rem;
        }
    </style>
</head>
<body>
    <h1>SOAP DNS Lookup Service Documentation</h1>
    <p>
        The SOAP DNS Lookup Service allows users to perform DNS lookups through a SOAP interface. 
        This service queries a given hostname or IP address using the <code>nslookup</code> command and returns the result in XML format.
    </p>

    <div class="note">
        <strong>Note:</strong> 
        Ensure your SOAP client or tool (e.g., Burp Repeater) includes the correct headers and SOAPAction. 
        Use this service only for educational purposes, as it can expose vulnerabilities at lower security levels.
    </div>

    <h2>Endpoint</h2>
    <pre><code>POST /webservices/soap/ws-dns-lookup.php</code></pre>

    <h2>SOAP Request Structure</h2>
    <pre><code>&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
                  xmlns:urn="urn:commandinjwsdl"&gt;
   &lt;soapenv:Header/&gt;
   &lt;soapenv:Body&gt;
      &lt;urn:lookupDNS&gt;
         &lt;targetHost&gt;example.com&lt;/targetHost&gt;
      &lt;/urn:lookupDNS&gt;
   &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;</code></pre>

    <h2>Example Using <code>curl</code></h2>
    <pre><code>curl -X POST "http://mutillidae.localhost/webservices/soap/ws-dns-lookup.php" \
 -H "Content-Type: text/xml; charset=utf-8" \
 -H "SOAPAction: \"urn:commandinjwsdl#lookupDNS\"" \
 --data '&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" \
        xmlns:urn="urn:commandinjwsdl"&gt;
   &lt;soapenv:Header/&gt;
   &lt;soapenv:Body&gt;
      &lt;urn:lookupDNS&gt;
         &lt;targetHost&gt;example.com&lt;/targetHost&gt;
      &lt;/urn:lookupDNS&gt;
   &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;'</code></pre>

    <h2>Expected XML Response</h2>
    <pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;results&gt;
  &lt;host&gt;example.com&lt;/host&gt;
  &lt;output&gt;&lt;![CDATA[
Server:  dns.google
Address: 8.8.8.8

Non-authoritative answer:
Name:    example.com
Address: 93.184.216.34
]]&gt;&lt;/output&gt;
&lt;/results&gt;</code></pre>

    <h2>Troubleshooting Tips</h2>
    <ul>
        <li>
            Ensure that the service is accessible at <code>mutillidae.localhost</code> and the correct SOAPAction header is used.
        </li>
        <li>
            If using Burp Repeater, verify the request body matches the structure shown in the example.
        </li>
        <li>
            If the response is empty or malformed, ensure the <code>nslookup</code> command works on the server.
        </li>
        <li>
            Check the service logs for details if the request fails due to security settings (e.g., command injection protection).
        </li>
    </ul>
</body>
</html>
